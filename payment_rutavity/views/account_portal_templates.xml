<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Override Pay Now button in invoice list to redirect to bulk payment page -->
    <template id="portal_my_invoices_payment_button_override" inherit_id="account_payment.portal_my_invoices_payment">
        <xpath expr="//td[hasclass('text-center')]/a[hasclass('btn')][hasclass('btn-sm')][hasclass('btn-primary')]" position="attributes">
            <attribute name="t-att-href"/>
            <attribute name="t-attf-href">/my/invoices/overdue?invoice_ids={{invoice.id}}</attribute>
        </xpath>
    </template>

    <!-- Override Pay Now button in invoice detail page to redirect to bulk payment page -->
    <template id="portal_invoice_payment_button_override" inherit_id="account_payment.portal_invoice_page_inherit_payment">
        <xpath expr="//t[@t-call='portal.portal_record_sidebar']//a[@data-bs-target='#pay_with']" position="attributes">
            <attribute name="href"/>
            <attribute name="data-bs-toggle"/>
            <attribute name="data-bs-target"/>
            <attribute name="t-attf-href">/my/invoices/overdue?invoice_ids={{invoice.id}}</attribute>
        </xpath>
    </template>

    <!-- Override the default invoice list URL to sort by most_overdue by default -->
    <template id="portal_my_home_invoice_url_override" inherit_id="account.portal_my_home_invoice" priority="40">
        <xpath expr="//div[@id='portal_client_category']/t[@t-call='portal.portal_docs_entry']/t[@t-set='url'][@t-value=&quot;'/my/invoices?filterby=invoices'&quot;]" position="replace">
            <t t-set="url" t-value="'/my/invoices?sortby=most_overdue&amp;filterby=pending_invoices'"/>
        </xpath>
    </template>

</odoo>

